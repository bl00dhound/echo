<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=5,IE=9" ><![endif]-->
<!DOCTYPE html>
<html>

<head>
	<title>echo_diagram</title>
	<meta charset="utf-8" />
	<style>
		li {
			margin-bottom: 20px;
			font-family: Arial, Helvetica, sans-serif;
		}
	</style>
</head>

<body style="display: flex;">
	<div class="mxgraph" style="max-width:100%;border:1px solid transparent;"
		data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;toolbar&quot;:&quot;zoom layers lightbox&quot;,&quot;edit&quot;:&quot;_blank&quot;,&quot;xml&quot;:&quot;&lt;mxfile host=\&quot;app.diagrams.net\&quot; modified=\&quot;2020-05-03T14:41:58.182Z\&quot; agent=\&quot;5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.122 Safari/537.36\&quot; etag=\&quot;WhEfLCt-LemuNoc9bPuy\&quot; version=\&quot;13.0.6\&quot; type=\&quot;device\&quot;&gt;&lt;diagram id=\&quot;0q2aHhF6JK3A_XAmWTjE\&quot; name=\&quot;Page-1\&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;&quot;}">
	</div>
	<div>
		<ol style="max-width: 580px;">
			<li>
				<div>Server with one endpoint:</div>
				<div>
					<code>
						curl --location --request POST 'localhost:3000/message' \ <br />
						--data-raw '{
						"msg": "the awesome message",
						"time": 1589322731352
						}'
					</code>
				</div>
			</li>
			<li>
				<div>
					Service that printing messages. Start every 100ms, move one message from "publish_queue" to
					"process_server_queue" and trying to print this one.
				</div>
			</li>
			<li>
				<div>Sorted set that store timestamps in ascending order. It uses for fast finding the timestamps for
					processing.</div>
			</li>
			<li>
				<div>
					Queues that store the messages with their display time. This is used to avoid the collision when somebody push
					messages with the same timestamps.
				</div>
			</li>
			<li>
				<div>
					Queue that store messages that need to be printed.
				</div>
			</li>
			<li>
				<div>
					Queue that is related to the server and store message that is in process of printing.
				</div>
			</li>
			<li>
				<div>
					Worker that provide cron-job tasks.
				</div>
			</li>
			<li>
				<div>
					A task which picks up timestamps earlier than now, pushes them to "process_queue" and removes timestamps.
				</div>
			</li>
			<li>
				<div>
					A task which clears up old timestamps. It starts one time per day.
				</div>
			</li>
		</ol>
	</div>
	<script type="text/javascript" src="https://app.diagrams.net/js/viewer.min.js"></script>
</body>

</html>